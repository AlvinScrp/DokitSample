apply plugin: 'kotlin'
apply plugin: 'kotlin-kapt'
apply plugin:  'maven-publish'
apply plugin: 'java-gradle-plugin'


sourceSets {
    main {
        java {
            srcDirs += []
        }
        kotlin {
            srcDirs += ['src/main/kotlin', 'src/main/java']
        }
    }


}

compileKotlin {
    kotlinOptions.jvmTarget = JavaVersion.VERSION_1_8
}


dependencies {
    compileOnly gradleApi()
    compileOnly localGroovy()

    //ç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ å¦åˆ™ä¼šè·Ÿé¡¹ç›®çš„asç‰ˆæœ¬å†²çª
    compileOnly "com.android.tools.build:gradle:4.2.2"
    /* ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ å¼•ç”¨è¿™ä¸¤ä¸ªæ¨¡å— ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ */
    api "com.didiglobal.booster:booster-api:4.10.0"
    api "com.didiglobal.booster:booster-transform-asm:4.10.0"
}

/**
 * åˆ é™¤æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶
 */
task deleteSource(type: Delete) {
    doLast {
        delete './src/main/kotlin'
    }
}


repositories {
    google()
//    jcenter()
    mavenCentral()
}

gradlePlugin {
    plugins {
        // å£°æ˜æ’ä»¶ä¿¡æ¯ï¼Œè¿™é‡Œçš„ hello åå­—éšæ„
        hello {
            // æ’ä»¶ID
            id = 'com.e.dokit'
            // æ’ä»¶çš„å®ç°ç±»
            implementationClass = 'com.didichuxing.doraemonkit.plugin.DoKitPlugin'
        }
    }
}

publishing {
    repositories {
        maven {
            // $rootDir è¡¨ç¤ºä½ é¡¹ç›®çš„æ ¹ç›®å½•
            url = "$rootDir/repo"
        }
    }
    publications {
        // è¿™é‡Œçš„ hello å¯ä»¥ä»»æ„å‘½å
        hello(MavenPublication) {
            // æ’ä»¶çš„ç»„IDï¼Œå»ºè®®è®¾ç½®ä¸ºæ’ä»¶çš„åŒ…å
            groupId = 'com.e.plugin'
            // ç¿»è¯‘è¿‡æ¥æ˜¯ å·¥ä»¶IDï¼Œæˆ‘çš„ç†è§£æ˜¯æ’ä»¶çš„åå­—
            artifactId = 'dokit'
            version = '0.0.17'
            // ç»„ä»¶ç±»å‹ï¼Œæˆ‘ä»¬çš„æ’ä»¶å…¶å®å°±æ˜¯Javaç»„ä»¶
            from components.java
        }
    }
}



